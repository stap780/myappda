<div class="row align-items-center mt-3 mb-3">
  <div class="col-2">
    <div class="col-md-12 p-0">
      <div class="h3">События</div>
    </div>
  </div>
  <div class="col-10 pl-0 pr-0 row">
    <div class="col-2">
      <div class="btn-group" role="group">
        <button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle btn-sm" data-bs-toggle="dropdown">Действия</button>
        <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
          <%= link_to 'Создать', new_event_path, class: 'dropdown-item' %>
        </div>
      </div>
    </div>
    <%= search_form_for @search, {class: 'form-inline col-10 pl-0 pr-0'} do |f| %>
      <div class="input-group input-group-sm">
      <%= f.select :casetype_in, Case::CASETYPE, { :prompt => 'Тип заявки'}, class: "form-select", style: "max-width: 180px;" %>
        <% if Insint.present_work? %>
        <%= f.select :custom_status_eq, ApiInsales.new(Insint.current).statuses, {include_blank: false, prompt: 'Статус'}, class: "form-select", style: "max-width: 180px;" %>
        <% else %>
        <%= f.search_field :custom_status_eq , placeholder: 'Статус', class: "form-control", style: "max-width: 180px;" %>
        <% end %>
        <%= f.select :financial_status_eq, Event::FIN_STATUS, { include_blank: false, prompt: 'Статус оплаты'}, class: "form-select", style: "max-width: 180px;" %>
        <%= button_tag(type: 'submit', :class => "btn btn-info") do %>
          <span class="oi oi-magnifying-glass"></span>
        <% end %>
        <%= link_to '<span class="oi oi-reload"></span>'.html_safe, events_path, class: 'btn btn-outline-dark ' %>
        <%# link_to '<span class="oi oi-trash"></span>'.html_safe, delete_selected_events_path, class: 'btn btn-secondary', id: 'deleteAll', remote: true %>
      </div>
    <% end %>
  </div>
</div>

<div class="table-responsive">
  <table class="table table-hover table-condensed">
  <thead>
    <tr class="bg-success">
      <th><%= check_box_tag 'selectAll', 'selectAll'%></th>
      <th>#</th>
      <th>Тип заявки</th>
      <th>Статус</th>
      <th>Фин Статус</th>
      <th>Действие</th>
      <th></th>
    </tr>
  </thead>

  <tbody id="items_table">
    <% @events.each do |event| %>
    <tr>
        <td><%= check_box_tag "event_ids[]", event.id %></td>
        <td><%= event.id %></td>
        <td><%= event.casetype_value %></td>
        <td><%= event.custom_status %></td>
        <td><%= event.fin_status %></td>
        <td><%= event.action_title %>
            <% if event.pause_text %><br><%= event.pause_text %><% end %>
            <% if event.timetable_text %><br><%= event.timetable_text %><% end %>
        </td>
        <td>
        <span class="d-flex">
             <br><%= link_to '<span class="oi oi-pencil"></span>'.html_safe, edit_event_path(event), class: "px-3" %>
             <br><%= link_to '<span class="oi oi-trash"></span>'.html_safe, event, method: :delete, data: { confirm: 'Are you sure?' } %>
        </span>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>


<div class="apple_pagination">
  <%= will_paginate @events %>
</div>
